**Date** : 2025-07-02
**Link** :   https://tryhackme.com/room/pyramidofpainax

## Hash Values : 

**Hash Value** : Hash value is a numeric value of a fixed length that uniquely identifies data. (Result of a hashing algorithm)
1. MD5
2. SHA -1
3. SHA -2
Every malware has a hash value which can change even with the slightest change.
A hash is not considered to be cryptographically secure if two files have the same hash value or digest.

## Ip Address :
**Zone** = Green
[Ip Address Info](https://tryhackme.com/room/whatisnetworking)
In the Pyramid of Pain, IP addresses are indicated with the colour green.
A actor can make it challenging to successfully carry out IP blocking is by using Fast Flux.
*Fast Flux* : a cybercriminal technique that involves rapidly changing the IP addresses associated with a malicious domain name.

[Any.run](https://any.run/) (Used as a sandbox Environment)

## Domain Name
**Zone** = teal
Let's step up the Pyramid of Pain and move on to Domain Names. You can see the transition of colours - from green to teal.
[DNS in detail](https://tryhackme.com/room/dnsindetail)

Attackers often purchase fake dns to redrict the users from real ones
Ex: ![[Pasted image 20250702173830.png]]

This is one of the examples of a Punycode attack used by the attackers to redirect users to a malicious domain that seems legitimate at first glance.

What is Punycode? As per [Jamf](https://www.jamf.com/blog/punycode-attacks/) , "Punycode is a way of converting words that cannot be written in ASCII, into a Unicode ASCII encoding."
What you saw in the URL above is  `adıdas.de`  which has the Punycode of  `http://xn--addas-o4a.de/`

Attackers usually hide the malicious domains under URL shorteners.  
- bit.ly
- goo.gl
- ow.ly
- s.id
- smarturl.it
- tiny.pl
- tinyurl.com
- x.co

## Host Artifact
**Zone** = Yellow
Host artifacts are the traces or observables that attackers leave on the system

## Network Artifacts
**Zone** = Yellow
A network artifact can be a user-agent string, C2 information, or URI patterns followed by the HTTP POST requests.An attacker might use a User-Agent string that hasn’t been observed in your environment before or seems out of the ordinary. The User-Agent is defined by [RFC2616](https://datatracker.ietf.org/doc/html/rfc2616#page-145) as the request-header field that contains the information about the user agent originating the request.
Network artifacts can be detected in Wireshark PCAPs

## Tools

Attackers would use the utilities to create malicious macro documents (maldocs) for spearphishing attempts, a backdoor that can be used to establish [C2 (Command and Control Infrastructure)](https://www.varonis.com/blog/what-is-c2/), any custom .EXE, and .DLL files, payloads, or password crackers.

Antivirus signatures, detection rules, and YARA rules can be great weapons for you to use against attackers at this stage.

[MalwareBazaar](https://bazaar.abuse.ch/) and [Malshare](https://malshare.com/) are good resources to provide you with access to the samples, malicious feeds, and YARA results - these all can be very helpful when it comes to threat hunting and incident response. 

For detection rules, [SOC Prime Threat Detection Marketplace](https://tdm.socprime.com/) is a great platform, where security professionals share their detection rules for different kinds of threats including the latest CVE's that are being exploited in the wild by adversaries.

Fuzzy hashing is also a strong weapon against the attacker's tools. Fuzzy hashing helps you to perform similarity analysis - match two files with minor differences based on the fuzzy hash values. One of the examples of fuzzy hashing is the usage of [SSDeep](https://ssdeep-project.github.io/ssdeep/index.html)..

## TTPs

TTPs stands for Tactics, Techniques & Procedures. This includes the whole [MITRE](https://attack.mitre.org/) [ATT&CK Matrix](https://attack.mitre.org/), which means all the steps taken by an adversary to achieve his goal, starting from phishing attempts to persistence and data exfiltration.

If you can detect and respond to the TTPs quickly, you leave the adversaries almost no chance to fight back







