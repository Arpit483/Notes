
**Date** : 2025-08-01
**Link** :   https://tryhackme.com/room/networkminer
**Description** : Learn how to use NetworkMiner to analyse recorded traffic files and practice network forensics activities.

# Network Miner in Forensics

The ultimate goal of network forensics is to provide sufficient information to detect malicious activities, security breaches, and network anomalies based on the network traffic. And NetworkMiner is a great tool to help, as it provides quick and useful hints on where to start from, specifically:
- Context of captured hosts like their IP and MAC, hostnames, or OS information
- List of potential attack indicators or anomalies like traffic spikes or port scans
- Tools or toolkits used to perform the potential attacks like Nmap


# What is NetworkMiner

## NetworkMiner in a Nutshell

|                            |                                                                                                                                                                               |
| -------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Capability**             | **Description**                                                                                                                                                               |
| Traffic sniffing           | It can intercept the traffic, sniff it, and collect and log packets that pass through the network.                                                                            |
| Parsing PCAP files         | It can parse pcap files and show the content of the packets in detail.                                                                                                        |
| Protocol analysis          | It can identify the used protocols from the parsed pcap file.                                                                                                                 |
| OS fingerprinting          | It can identify the used OS by reading the pcap file. This feature strongly relies on [Satori](https://github.com/xnih/satori/) and [p0f](https://lcamtuf.coredump.cx/p0f3/). |
| File Extraction            | It can extract images, HTML files and emails from the parsed pcap file.                                                                                                       |
| Credential grabbing        | It can extract credentials from the parsed pcap file.                                                                                                                         |
| Clear text keyword parsing | It can extract cleartext keywords and strings from the parsed pcap file.                                                                                                      |

## Operating Modes

There are two main operating modes : 
- Sniffer Mode: Although it has a sniffing feature, it is not intended to use as a sniffer. The sniffier feature is available only on Windows. However, the rest of the features are available in Windows and Linux OS. (Not Recommended to use Sniffer tool)

- Packet Parsing/Processing: NetworkMiner can parse traffic captures to have a quick overview and information on the investigated capture. This operation mode is mainly suggested to grab the "low hanging fruit" before diving into a deeper investigation.


## Pros and Cons

**Pros  
- OS fingerprinting
- Easy file extraction  
- Credential grabbing
- Clear text keyword parsing
- Overall overview

**Cons**
- Not useful in active sniffing
- Not useful for large pcap investigation
- Limited filtering
- Not built for manual traffic investigation

## Differences Between Wireshark and NetworkMiner

|                             |                                                      |                   |
| --------------------------- | ---------------------------------------------------- | ----------------- |
| **Feature**                 | **NetworkMiner**                                     | **Wireshark**     |
| Purpose                     | Quick overview, traffic mapping, and data extraction | In-Depth analysis |
| GUI                         | ✅                                                    | ✅                 |
| Sniffing                    | ✅                                                    | ✅                 |
| Handling PCAPS              | ✅                                                    | ✅                 |
| OS Fingerprinting           | ✅                                                    | ❌                 |
| Parameter/Keyword Discovery | ✅                                                    | Manual            |
| Credential Discovery        | ✅                                                    | ✅                 |
| File Extraction             | ✅                                                    | ✅                 |
| Filtering Options           | Limited                                              | ✅                 |
| Packet Decoding             | Limited                                              | ✅                 |
| Protocol Analysis           | ❌                                                    | ✅                 |
| Payload Analysis            | ❌                                                    | ✅                 |
| Statistical Analysis        | ❌                                                    | ✅                 |
| Cross-Platform Support      | ✅                                                    | ✅                 |
| Host Categorisation         | ✅                                                    | ❌                 |
| Ease of Management          | ✅                                                    | ✅                 |


# Tool Overview 1

## Answer the questions below

1. **Use mx-3.pcap** . What is the total number of frames?
Ans :  460
![[Pasted image 20250801230544.png]]
![[Pasted image 20250801230528.png]]


2. How many IP addresses use the same MAC address with host 145.253.2.203?
Ans : 2
![[Pasted image 20250801230825.png]]

3. How many packets were sent from host 65.208.228.223?
Ans : 72
![[Pasted image 20250801230937.png]]

4. What is the name of the webserver banner under host 65.208.228.223?
Ans : Apache
![[Pasted image 20250801231044.png]]

5. **Use mx-4.pcap**. What is the extracted username?
Ans : `#B\Administrator
![[Pasted image 20250802001949.png]]


6. What is the extracted password?
Ans: $NETNTLMv2$#B$136B077D942D9A63$FBFF3C253926907AAAAD670A9037F2A5$01010000000000000094D71AE38CD60170A8D571127AE49E00000000020004003300420001001E003000310035003600360053002D00570049004E00310036002D004900520004001E0074006800720065006500620065006500730063006F002E0063006F006D0003003E003000310035003600360073002D00770069006E00310036002D00690072002E0074006800720065006500620065006500730063006F002E0063006F006D0005001E0074006800720065006500620065006500730063006F002E0063006F006D00070008000094D71AE38CD601060004000200000008003000300000000000000000000000003000009050B30CECBEBD73F501D6A2B88286851A6E84DDFAE1211D512A6A5A72594D340A001000000000000000000000000000000000000900220063006900660073002F003100370032002E00310036002E00360036002E0033003600000000000000000000000000


# Tool Overview 2

## Answer the questions below

1. **Use mx-7 pcap**. What is the name of the Linux distro mentioned in the file associated with frame 63075?
Ans: CentOS

![[Pasted image 20250802003139.png]]

2. What is the header of the page associated with frame 75942?
Ans : Password-Ned AB
![[Pasted image 20250802003938.png]]

3. What is the source address of the image "ads.bmp.2E5F0FD9.bmp"?
Ans : 80.239.178.187
![[Pasted image 20250802004150.png]]

4. What is the frame number of the possible TLS anomaly?
Ans : 36255
![[Pasted image 20250802004314.png]]

5. **Use mx-9 file**. Look at the messages. Which platform sent a password reset email?
Ans : Facebook
![[Pasted image 20250802004728.png]]

6. What is the email address of Branson Matheson?
Ans : branson@sandsite.org
![[Pasted image 20250802005013.png]]



# Exercises

## Answer the questions below

1. **Use case1.pcap**. What is the OS name of the host 131.151.37.122?
Ans : Windows - Windows NT 4 
![[Pasted image 20250802005343.png]]

2. Investigate the hosts 131.151.37.122 and 131.151.32.91. How many data bytes were received from host 131.151.32.91 to host 131.151.37.122 through port 1065?
Ans : 192

3. Investigate the hosts 131.151.37.122 and 131.151.32.21.  How many data bytes were received from host 131.151.37.122 to host 131.151.32.21 through port 143?
Ans : 20769

4. What is the sequence number of frame 9?
Ans : 2AD77400 (Try old version to find the answer)

5. What is the number of the detected "content types"?
Ans : 2

6. Use case2.pcap and investigate the files. What is the USB product's brand name?
Ans : ASIX

7. What is the name of the phone model?
Ans : Lumia 535

8. What is the source IP of the fish image?
Ans : 50.22.95.9

9. What is the password of the "homer.pwned.se@gmx.com"?
Ans : spring2015

10. What is the DNS Query of frame 62001?
Ans : pop.gmx.com

