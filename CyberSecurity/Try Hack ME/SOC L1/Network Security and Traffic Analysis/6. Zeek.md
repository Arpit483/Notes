**Date** : 2025-08-02
**Link** :   https://tryhackme.com/room/zeekbro
**Description** : Introduction to hands-on network monitoring and threat detection with Zeek (formerly Bro).

# Introduction

Zeek (formerly Bro) is an open-source and commercial network monitoring tool (traffic analyser).
[The official description;](https://docs.zeek.org/en/master/about.html) "Zeek (formerly Bro) is the world's leading platform for network security monitoring. Flexible, open-source, and powered by defenders." "Zeek is a passive, open-source network traffic analyser. Many operators use Zeek as a network security monitor (NSM) to support suspicious or malicious activity investigations. Zeek also supports a wide range of traffic analysis tasks beyond the security domain, including performance measurement and troubleshooting."


# Network Security Monitoring and Zeek

## Introduction to Network Monitoring Approaches

Network monitoring is a set of management actions to watch/continuously overview and optionally save the network traffic for further investigation.

## Network Monitoring

Network monitoring is highly focused on IT assets like uptime (availability), device health and connection quality (performance), and network traffic balance and management (configuration). Monitoring and visualising the network traffic, troubleshooting, and root cause analysis are also part of the Network Monitoring process.

## Network Security Monitoring

Monitoring network anomalies

## What is Zeek
Zeek (formerly Bro) is an open-source and commercial passive Network Monitoring tool (traffic analysis framework)

## Zeek vs Snort

While both are called IDS/NIDS, it is good to know the cons and pros of each tool and use them in a specific manner. While there are some overlapping functionalities, they have different purposes for usage.

|                     |                                                                                                                                                                                                                    |                                                                                                                                                         |
| ------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Tool**            | **Zeek**                                                                                                                                                                                                           | **Snort**                                                                                                                                               |
| **Capabilities**    | NSM and IDS framework. It is heavily focused on network analysis. It is more focused on specific threats to trigger alerts. The detection mechanism is focused on events.                                          | An IDS/IPS system. It is heavily focused on signatures to detect vulnerabilities. The detection mechanism is focused on signature patterns and packets. |
| **Cons**            | Hard to use.<br><br>The analysis is done out of the Zeek, manually or by automation.                                                                                                                               | Hard to detect complex threats.                                                                                                                         |
| **Pros**            | It provides in-depth traffic visibility.<br><br>Useful for threat hunting.<br><br>Ability to detect complex threats.<br><br>It has a scripting language and supports event correlation. <br><br>Easy to read logs. | Easy to write rules.<br><br>Cisco supported rules.<br><br>Community support.                                                                            |
| **Common Use Case** | Network monitoring.  <br>In-depth traffic investigation.  <br>Intrusion detecting in chained events.                                                                                                               | Intrusion detection and prevention.  <br>Stop known attacks/threats.                                                                                    |

## Zeek Architecture

![](https://tryhackme-images.s3.amazonaws.com/user-uploads/6131132af49360005df01ae3/room-content/07d58ecdaa53829df19be1ec47d2d666.png)


Zeek has two primary layers; "Event Engine" and "Policy Script Interpreter". The Event Engine layer is where the packets are processed; it is called the event core and is responsible for describing the event without focusing on event details. It is where the packages are divided into parts such as source and destination addresses, protocol identification, session analysis and file extraction.
The Policy Script Interpreter layer is where the semantic analysis is conducted. It is responsible for describing the event correlations by using Zeek scripts.

## Zeek Framework

**Available Frameworks**

| Logging   | Notice               | Input      | Configuration   | Intelligence   |
| --------- | -------------------- | ---------- | --------------- | -------------- |
| Cluster   | Broker Communication | Supervisor | GeoLocation     | File Analysis  |
| Signature | Summary              | NetControl | Packet Analysis | TLS Decryption |
You can read more on frameworks [**here**](https://docs.zeek.org/en/master/frameworks/index.html).

## Zeek Outputs

As mentioned before, Zeek provides 50+ log files under seven different categories, which are helpful in various areas such as traffic monitoring, intrusion detection, threat hunting and web analytics.
Once you run Zeek, it will automatically start investigating the traffic or the given pcap file and generate logs automatically. Once you process a pcap with Zeek, it will create the logs in the working directory. If you run the Zeek as a service, your logs will be located in the default log path. The default log path is: `/opt/zeek/logs/`

## Working with Zeek
![[Pasted image 20250803114456.png]]

|               |                                           |
| ------------- | ----------------------------------------- |
| **Parameter** | **Description**                           |
| **-r**        | Reading option, read/process a pcap file. |
| **-C**        | Ignoring checksum errors.                 |
| **-v**        | Version information.                      |
| **zeekctl**   | ZeekControl module.                       |

# Zeek Logs
